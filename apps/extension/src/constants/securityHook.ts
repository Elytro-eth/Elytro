import { Address } from 'viem';
import { arbitrum, mainnet, optimism, optimismSepolia, sepolia } from 'viem/chains';

export const SECURITY_HOOK_ADDRESS_MAP: Record<number, Address> = {
  [optimismSepolia.id]: '0xd4e23c76e56532c0620f0b80e62918cc7ca9d442' as Address,
  [sepolia.id]: '0xd4e23c76e56532c0620f0b80e62918cc7ca9d442' as Address,
  [arbitrum.id]: '0xd4e23c76e56532c0620f0b80e62918cc7ca9d442',
  [mainnet.id]: '0xd4e23c76e56532c0620f0b80e62918cc7ca9d442',
  [optimism.id]: '0xd4e23c76e56532c0620f0b80e62918cc7ca9d442',
};

export const CAPABILITY_FLAGS = {
  SIGNATURE_ONLY: 1, // only signature needs to go through hook
  USER_OP_ONLY: 2, // only user operation needs to go through hook
  BOTH: 3, // signature and user operation need to go through hook
} as const;

export const DEFAULT_SECURITY_HOOK_CAPABILITY = CAPABILITY_FLAGS.USER_OP_ONLY;

export const DEFAULT_SECURITY_HOOK_CONFIG = {
  safetyDelay: 2, //7 * 24 * 60 * 60, //default safety delay: 7 days
  capabilityFlags: CAPABILITY_FLAGS.USER_OP_ONLY, //default capability flags: only user operation needs to go through hook
} as const;

export const FAKE_SECURITY_HOOK_BYTECODE =
  '0x6080806040526004361015610012575f80fd5b5f3560e01c90816301ffc9a714610906575080630e316ab714610856578063205cade8146107fb578063715018a614610761578063736c0d5b146106f65780638c1dcf37146105b85780638da5cb5b14610568578063a14287be146104c7578063c89109131461043a578063d3946221146103be578063eb12d61e1461030b578063f2fde38b1461021c5763f8dd3fdb146100ab575f80fd5b34610218575f7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc36011261021857335f52600260205260405f20805460ff8116156101f05767ffffffffffffffff8160281c166101c85763ffffffff9060081c1667ffffffffffffffff4216019067ffffffffffffffff821161019b5780547fffffffffffffffffffffffffffffffffffffff0000000000000000ffffffffff6cffffffffffffffff00000000008460281b16911617905567ffffffffffffffff604051911681527f040173890d7fad4f8447d822c22310a766dcea4325cb0485bb46c8a73f57305f60203392a2005b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b7fe7b067d6000000000000000000000000000000000000000000000000000000005f5260045ffd5b7f3da3f98c000000000000000000000000000000000000000000000000000000005f5260045ffd5b5f80fd5b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043573ffffffffffffffffffffffffffffffffffffffff811680910361021857610274610d91565b80156102df5773ffffffffffffffffffffffffffffffffffffffff5f54827fffffffffffffffffffffffff00000000000000000000000000000000000000008216175f55167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e05f80a3005b7f1e4fbdf7000000000000000000000000000000000000000000000000000000005f525f60045260245ffd5b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043573ffffffffffffffffffffffffffffffffffffffff811680910361021857610363610d91565b805f52600160205260405f2060017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff008254161790557f127e24532ec9706d989bcc63d21bccafe179ff3fe25307a38ce088ac4448e5045f80a2005b34610218575f7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc36011261021857335f52600260205260ff60405f2054161561041257335f90815260026020526040812055005b7f8fc98e44000000000000000000000000000000000000000000000000000000005f5260045ffd5b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043573ffffffffffffffffffffffffffffffffffffffff8116809103610218575f526002602052606060405f205467ffffffffffffffff6040519160ff81161515835263ffffffff8160081c16602084015260281c166040820152f35b346102185760807ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043567ffffffffffffffff8111610218576101207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc8236030112610218576064359067ffffffffffffffff82116102185761055961056692369060040161098c565b9160243590600401610aad565b005b34610218575f7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc36011261021857602073ffffffffffffffffffffffffffffffffffffffff5f5416604051908152f35b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043567ffffffffffffffff81116102185761060790369060040161098c565b90335f52600260205260405f2091825460ff81166106ce577fffffffffffffffffffffffffffffffffffffff0000000000000000ffffffff00166001178355600411610218573560e081901c80159081156106c0575b506106985781547fffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000ff1660d89190911c64ffffffff0016179055005b7f96a65ff4000000000000000000000000000000000000000000000000000000005f5260045ffd5b6301e133809150118361065d565b7f439a74c9000000000000000000000000000000000000000000000000000000005f5260045ffd5b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043573ffffffffffffffffffffffffffffffffffffffff8116809103610218575f526001602052602060ff60405f2054166040519015158152f35b34610218575f7ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc36011261021857610797610d91565b5f73ffffffffffffffffffffffffffffffffffffffff81547fffffffffffffffffffffffff000000000000000000000000000000000000000081168355167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e08280a3005b346102185760407ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760243567ffffffffffffffff81116102185761084d61056691369060040161098c565b90600435610ddd565b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc3601126102185760043573ffffffffffffffffffffffffffffffffffffffff8116809103610218576108ae610d91565b805f52600160205260405f207fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0081541690557ffa15964370ccf7acface74df78a85aa4857e703226c446d3e24a69663dc302e75f80a2005b346102185760207ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc36011261021857600435907fffffffff000000000000000000000000000000000000000000000000000000008216809203610218577f811e2a5600000000000000000000000000000000000000000000000000000000602092148152f35b9181601f840112156102185782359167ffffffffffffffff8311610218576020838186019501011161021857565b9035907fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe181360301821215610218570180359067ffffffffffffffff82116102185760200191813603831361021857565b92919267ffffffffffffffff8211610a8057604051917fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe0603f81601f8401160116830183811067ffffffffffffffff821117610a8057604052829481845281830111610218578281602093845f960137010152565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b92919082610d8757505050606081016004610ac882846109ba565b9050101580610d2b575b610aff575b7f5fff7ed7000000000000000000000000000000000000000000000000000000005f5260045ffd5b610b08916109ba565b8060041161021857810160607ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc83830301126102185760048201359173ffffffffffffffffffffffffffffffffffffffff83168093036102185760448101359067ffffffffffffffff821161021857019080602383011215610218578160246004610b969401359101610a0b565b80516004811015610ba8575b50610ad7565b602082015192308103610c0d575050507fffffffff00000000000000000000000000000000000000000000000000000000167ff8dd3fdb0000000000000000000000000000000000000000000000000000000014610c0b57505b5f808080610ba2565b565b929091923314610c21575b50505050610c02565b7fffffffff00000000000000000000000000000000000000000000000000000000167f55625be800000000000000000000000000000000000000000000000000000000149081610d20575b50610c79575b8080610c18565b6024015173ffffffffffffffffffffffffffffffffffffffff163014610c9f5780610c72565b335f52600260205260405f205460ff8116156101f05760281c67ffffffffffffffff168015610cf8574210610cd057565b7f07923fb8000000000000000000000000000000000000000000000000000000005f5260045ffd5b7fe3f55266000000000000000000000000000000000000000000000000000000005f5260045ffd5b60249150145f610c6c565b50610d3681836109ba565b60041161021857357fffffffff00000000000000000000000000000000000000000000000000000000167fb61d27f60000000000000000000000000000000000000000000000000000000014610ad2565b610c0b9350610ddd565b73ffffffffffffffffffffffffffffffffffffffff5f54163303610db157565b7f118cdaa7000000000000000000000000000000000000000000000000000000005f523360045260245ffd5b610e0b90610e05610e149373ffffffffffffffffffffffffffffffffffffffff953691610a0b565b90610e1e565b90929192610e58565b165f526001602052565b8151919060418303610e4e57610e479250602082015190606060408401519301515f1a90610f30565b9192909190565b50505f9160029190565b6004811015610f035780610e6a575050565b60018103610e9a577ff645eedf000000000000000000000000000000000000000000000000000000005f5260045ffd5b60028103610ece57507ffce698f7000000000000000000000000000000000000000000000000000000005f5260045260245ffd5b600314610ed85750565b7fd78bce0c000000000000000000000000000000000000000000000000000000005f5260045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602160045260245ffd5b91907f7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a08411610fbf579160209360809260ff5f9560405194855216868401526040830152606082015282805260015afa15610fb4575f5173ffffffffffffffffffffffffffffffffffffffff811615610faa57905f905f90565b505f906001905f90565b6040513d5f823e3d90fd5b5050505f916003919056';
